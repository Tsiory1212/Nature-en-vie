{% extends 'base.html.twig' %}

{% block title %} {{abonnement.nameSubscriptionPlan}} {% endblock %}

{% block stylesheets %}
  
{% endblock %}

{% block body %}

    <body>
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <div class="card text-center" style="width: 100rem;">
                        {# <img src="/biolife/assets/images/logo-bio.jpeg" class="card-img-top" alt="..."> #}
                        <div class="card-body">
                        
                            <h5 class="card-title">{{ abonnement.nameSubscriptionPlan }}</h5>
                            <p class="card-text">{{ abonnement.descriptionSubscriptionPlan }}</p>
                            <p class="card-text">{{ abonnement.priceSubscription }} €</p>
                            <div id="paypal-button-container"></div>



                                
                            {# <form action="https://www.sandbox.paypal.com/cgi-bin/webscr" method="post" target="_top">
                                <input type="hidden" name="cmd" value="_s-xclick">
                                <input type="submit" class="btn btn-primary" value="S'abonner" name="submit">
                                <!-- <input type="image" src="https://www.sandbox.paypal.com/fr_FR/FR/i/btn/btn_subscribeCC_LG.gif" border="0" name="submit" alt="PayPal, le réflexe sécurité pour payer en ligne"> -->
                                <img alt="" border="0" src="https://www.sandbox.paypal.com/fr_FR/i/scr/pixel.gif" width="1" height="1">
                            </form> #}
                                
                        </div>
                    </div>
                </div>
            </div>
        </div>     
    </body>

{% endblock %}


{% block javascripts %}

        <script src="https://www.paypal.com/sdk/js?client-id={{paypal_client_id}}&vault=true"> </script>

		<script>
			paypal.Buttons({
				env: 'sandbox',
                style: {
                    shape: 'rect',
                    color: 'gold',
                    layout: 'horizontal',
                    label: 'subscribe'
                },
				createSubscription: function (data, actions) {
					return actions.subscription.create({
                        'plan_id': "{{idSubscriptionPlanPaypal}}"
					});
				},
				onApprove: function (data, actions) {
                    const url = "/account/abonnement/"+{{abonnement.id}}+"/"+data.subscriptionID;
                    
                    axios.post(url)
                        .then(function(response){                            
                            if(response.data.code == '200'){
                                alert('Subscription successfull')
                            }
                        })
				},
				onCancel: function (data) {
					alert("Abonnement annulé : vous avez fermé la fenêtre de paiement.");
				},
				onError: function (err) {
					alert("Abonnement annulé : une erreur est survenue. Merci de bien vouloir réessayer ultérieurement.");
				}
			}).render('#paypal-button-container');
		</script>









<!-- 

<div id="paypal-button-container-P-179440294N734110DMGSAHTI"></div>
<script src="https://www.paypal.com/sdk/js?client-id=ARSTQbtgKeoNm6KrANMC-kFabQEBKmVQMKlI_chSOVuazehPZdIbFFKsSJpw4By4IlXcwtfNnm_5hm-5&vault=true&intent=subscription" data-sdk-integration-source="button-factory"></script>
<script>
  paypal.Buttons({
      style: {
          shape: 'rect',
          color: 'gold',
          layout: 'horizontal',
          label: 'subscribe'
      },
      createSubscription: function(data, actions) {
        return actions.subscription.create({
          /* Creates the subscription */
          plan_id: 'P-179440294N734110DMGSAHTI'
        });
      },
      onApprove: function(data, actions) {
        alert(data.subscriptionID); // You can add optional success message for the subscriber here
      }
  }).render('#paypal-button-container-P-179440294N734110DMGSAHTI'); // Renders the PayPal button
</script> -->


    
{% endblock %}

